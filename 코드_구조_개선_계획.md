# 🏗️ 코드 구조 개선 계획서

**작성일**: 2025년 1월  
**목적**: App.vue (9,533줄)와 api-server.js (2,139줄)의 모듈화 및 컴포넌트 분리

---

## 📋 현재 상태 분석

### 문제점
- ❌ `App.vue`: 9,533줄 (단일 파일에 모든 기능 집중) → **개선 진행 중**
- ❌ `api-server.js`: 2,139줄 (단일 파일에 모든 API 로직 집중) → **대기 중**
- ❌ 컴포넌트 재사용성 낮음 → **개선 진행 중**
- ❌ 테스트 작성 어려움 → **개선 진행 중**
- ❌ 유지보수 어려움 → **개선 진행 중**

### 현재 구조 (2025년 1월 업데이트)
```
src/
├── App.vue (9,533줄) ⚠️ 리팩토링 진행 중
├── components/
│   ├── features/          ✅ 생성됨 (컴포넌트 분리 준비)
│   ├── modals/            ✅ 생성됨
│   ├── LoginModal.vue     ✅
│   └── SignupModal.vue   ✅
├── services/              ✅ 신규 생성
│   ├── api.js             ✅ 완료
│   └── newsService.js     ✅ 완료
├── stores/
│   └── auth.js            ✅
├── utils/                 ✅ 신규 생성
│   └── helpers.js         ✅ 완료
└── style.css
```

### 진행 상황 (2025년 1월)
- ✅ **Phase 1 완료**: 유틸리티 함수 분리
- ✅ **Phase 2 완료**: API 서비스 레이어 생성
- 🔄 **Phase 3 진행 중**: 프론트엔드 컴포넌트 분리
- ⏳ **Phase 4 대기**: 백엔드 모듈화

### 이전 진행 상황 (리팩토링_진행_상황.md 통합)
- ✅ 컴포넌트 폴더 구조 생성 (`src/components/`)
- ✅ LoginModal.vue 컴포넌트 생성 및 분리 완료
- ✅ SignupModal.vue 컴포넌트 생성 및 분리 완료
- ✅ Props/Emits 패턴 적용 완료
- 🔄 App.vue에 새 컴포넌트 통합 진행 중

---

## 🎯 개선 목표 구조

### 목표 구조
```
src/
├── App.vue (메인 레이아웃만, ~200줄)
├── components/
│   ├── features/          # 기능별 컴포넌트
│   │   ├── NewsSearch.vue
│   │   ├── EconomyNewsSearch.vue
│   │   ├── MusicRecommend.vue
│   │   ├── BookRecommend.vue
│   │   ├── RadioHistory.vue
│   │   └── ScreenValidation.vue
│   ├── modals/           # 모달 컴포넌트
│   │   ├── LoginModal.vue ✅ (기존)
│   │   ├── SignupModal.vue ✅ (기존)
│   │   ├── UserManagementModal.vue
│   │   ├── MCPGuideModal.vue
│   │   └── EconomyAlarmModal.vue
│   └── common/           # 공통 컴포넌트
│       ├── Header.vue
│       ├── ArticleCard.vue
│       └── LoadingSpinner.vue
├── services/             # API 서비스 레이어
│   ├── api.js            # API 호출 함수들
│   ├── newsService.js
│   ├── musicService.js
│   ├── bookService.js
│   └── authService.js
├── stores/               # 상태 관리
│   ├── auth.js ✅ (기존)
│   ├── news.js
│   └── music.js
├── utils/                # 유틸리티 함수
│   ├── helpers.js
│   ├── dateFormatter.js
│   └── dataAnalysis.js
└── style.css
```

---

## 📝 단계별 개선 계획

### Phase 1: 유틸리티 함수 분리 (1일)

**목표**: 공통 함수들을 utils로 분리

**작업 내용:**
- [ ] `utils/helpers.js` 생성
  - `formatDate()` 함수 이동
  - 기타 헬퍼 함수들 이동
- [ ] `utils/dateFormatter.js` 생성
  - 날짜 포맷팅 관련 함수들
- [ ] `utils/dataAnalysis.js` 생성
  - `analyzeDataCorrelation()` 함수 이동
  - 데이터 분석 관련 함수들

**예상 효과:**
- 코드 재사용성 향상
- 테스트 작성 용이

---

### Phase 2: API 서비스 레이어 생성 (2일)

**목표**: API 호출 로직을 services로 분리

**작업 내용:**
- [ ] `services/api.js` 생성
  - 기본 API 호출 함수 (`fetch`, 에러 처리)
- [ ] `services/newsService.js` 생성
  - `searchAIArticles()`
  - `fetchLatestAINews()`
  - `fetchLatestEconomyNews()`
- [ ] `services/musicService.js` 생성
  - `recommendSimilarSongs()`
  - `getRadioSongs()`
- [ ] `services/bookService.js` 생성
  - `recommendBooks()`
  - `getPopularBooks()`
- [ ] `services/authService.js` 생성
  - 사용자 인증 관련 API 호출

**예상 효과:**
- API 로직 중앙화
- 에러 처리 통일
- 테스트 용이

---

### Phase 3: 프론트엔드 컴포넌트 분리 (3-5일)

**목표**: App.vue를 기능별 컴포넌트로 분리

**작업 내용:**

#### 3-1. 뉴스 검색 컴포넌트
- [ ] `components/features/NewsSearch.vue` 생성
  - AI 뉴스 검색 UI 및 로직
  - 데이터 연계도 분석 표시
  - 네트워크 그래프 표시
- [ ] `components/features/EconomyNewsSearch.vue` 생성
  - 경제 뉴스 검색 UI 및 로직

#### 3-2. 음악/도서 컴포넌트
- [ ] `components/features/MusicRecommend.vue` 생성
  - 음악 추천 UI 및 로직
- [ ] `components/features/BookRecommend.vue` 생성
  - 도서 추천 UI 및 로직
- [ ] `components/features/RadioHistory.vue` 생성
  - 라디오 수집 현황 UI 및 로직

#### 3-3. 모달 컴포넌트
- [ ] `components/modals/UserManagementModal.vue` 생성
  - 사용자 관리 모달 (프로필, 데이터, API 키, 계정 삭제)
- [ ] `components/modals/MCPGuideModal.vue` 생성
  - MCP 가이드 모달
- [ ] `components/modals/EconomyAlarmModal.vue` 생성
  - 경제 뉴스 알람 모달

#### 3-4. 공통 컴포넌트
- [ ] `components/common/Header.vue` 생성
  - 상단 버튼 영역
- [ ] `components/common/ArticleCard.vue` 생성
  - 뉴스 기사 카드 컴포넌트
- [ ] `components/common/LoadingSpinner.vue` 생성
  - 로딩 스피너 컴포넌트

**예상 효과:**
- App.vue 크기 대폭 감소 (9,533줄 → ~500줄)
- 컴포넌트 재사용성 향상
- 유지보수 용이

---

### Phase 4: 백엔드 모듈화 (3-5일)

**목표**: api-server.js를 routes, controllers, services로 분리

**작업 내용:**

#### 4-1. 디렉토리 구조 생성
```
api-server/
├── routes/
│   ├── news.js
│   ├── music.js
│   ├── books.js
│   ├── auth.js
│   └── index.js
├── controllers/
│   ├── newsController.js
│   ├── musicController.js
│   ├── booksController.js
│   └── authController.js
├── services/
│   ├── newsService.js
│   ├── musicService.js
│   ├── booksService.js
│   └── authService.js
├── middleware/
│   ├── auth.js
│   ├── rateLimit.js
│   └── errorHandler.js
├── utils/
│   ├── httpClient.js
│   └── helpers.js
└── server.js (메인 서버 파일)
```

#### 4-2. 라우트 분리
- [ ] `routes/news.js` 생성
  - `/api/news` 엔드포인트
  - `/api/news/economy` 엔드포인트
- [ ] `routes/music.js` 생성
  - `/api/music/recommend` 엔드포인트
  - `/api/music/radio/*` 엔드포인트
- [ ] `routes/books.js` 생성
  - `/api/books/*` 엔드포인트
- [ ] `routes/auth.js` 생성
  - `/api/auth/*` 엔드포인트

#### 4-3. 컨트롤러 분리
- [ ] 각 라우트에 대응하는 컨트롤러 생성
- [ ] 요청/응답 처리 로직 이동

#### 4-4. 서비스 레이어 분리
- [ ] 외부 API 호출 로직을 서비스로 이동
- [ ] 비즈니스 로직 분리

#### 4-5. 미들웨어 분리
- [ ] 인증 미들웨어 분리
- [ ] 에러 처리 미들웨어 분리
- [ ] Rate Limiting 미들웨어 추가

**예상 효과:**
- api-server.js 크기 대폭 감소 (2,139줄 → ~100줄)
- 모듈화로 인한 유지보수 용이
- 테스트 작성 용이

---

## 🚀 실행 계획

### Week 1: 프론트엔드 개선
- Day 1-2: 유틸리티 함수 분리
- Day 3-4: API 서비스 레이어 생성
- Day 5-7: 주요 컴포넌트 분리 (뉴스, 음악, 도서)

### Week 2: 프론트엔드 완료 + 백엔드 시작
- Day 1-3: 나머지 컴포넌트 분리 (모달, 공통 컴포넌트)
- Day 4-5: App.vue 리팩토링 완료
- Day 6-7: 백엔드 디렉토리 구조 생성

### Week 3: 백엔드 모듈화
- Day 1-3: 라우트 및 컨트롤러 분리
- Day 4-5: 서비스 레이어 분리
- Day 6-7: 미들웨어 분리 및 테스트

---

## ✅ 체크리스트

### 프론트엔드
- [x] 유틸리티 함수 분리 완료 ✅ (2025-01)
- [x] API 서비스 레이어 생성 완료 ✅ (2025-01)
- [ ] NewsSearch 컴포넌트 분리 완료 🔄 진행 중
- [ ] EconomyNewsSearch 컴포넌트 분리 완료 ⏳ 대기
- [ ] MusicRecommend 컴포넌트 분리 완료 ⏳ 대기
- [ ] BookRecommend 컴포넌트 분리 완료 ⏳ 대기
- [ ] UserManagementModal 컴포넌트 분리 완료 ⏳ 대기
- [ ] App.vue 리팩토링 완료 (9,533줄 → ~500줄) 🔄 진행 중

### 백엔드
- [ ] 디렉토리 구조 생성 완료
- [ ] 라우트 분리 완료
- [ ] 컨트롤러 분리 완료
- [ ] 서비스 레이어 분리 완료
- [ ] 미들웨어 분리 완료
- [ ] api-server.js 리팩토링 완료 (2,139줄 → ~100줄)

---

## 📊 예상 개선 효과

### 코드 품질
- **순환 복잡도**: 높음 → 낮음
- **코드 재사용성**: 낮음 → 높음
- **테스트 작성 용이성**: 어려움 → 쉬움

### 유지보수성
- **파일 크기**: 매우 큼 → 적절함
- **코드 탐색**: 어려움 → 쉬움
- **버그 수정**: 어려움 → 쉬움

### 협업
- **병렬 작업**: 어려움 → 쉬움
- **코드 리뷰**: 어려움 → 쉬움
- **온보딩**: 어려움 → 쉬움

---

## 🎯 우선순위

### 높은 우선순위 (즉시 시작)
1. ✅ 유틸리티 함수 분리
2. ✅ API 서비스 레이어 생성
3. ✅ NewsSearch 컴포넌트 분리

### 중간 우선순위 (1주일 내)
4. ✅ 나머지 기능 컴포넌트 분리
5. ✅ 모달 컴포넌트 분리
6. ✅ App.vue 리팩토링

### 낮은 우선순위 (2주일 내)
7. ✅ 백엔드 모듈화 시작
8. ✅ 미들웨어 분리
9. ✅ 테스트 추가

---

**작성일**: 2025년 1월  
**버전**: 1.0.0

